{"is_source_file": true, "format": "Python", "description": "This file contains a Python implementation of a client for the Confluence API, supporting OAuth2 and API key authentication, with methods for listing spaces, pages, comments, and creating pages, including request handling with retries and pagination.", "external_files": ["src.core.logging_config"], "external_methods": ["get_logger"], "published": ["ConfluenceAuth", "ConfluenceClient"], "classes": [{"name": "ConfluenceAuth", "description": "Handles authentication details for Confluence API, supporting API key and OAuth2 methods, token management, and header generation."}, {"name": "ConfluenceClient", "description": "Client for interacting with Confluence API endpoints, managing request retries, pagination, and making API calls for spaces, pages, comments, and page creation."}], "methods": [{"name": "None set_token(self, token: str, expires_in: Optional[int] = None)", "description": "Sets the access token and optional expiry time for OAuth2 authentication.", "scope": "ConfluenceAuth", "scopeKind": "class"}, {"name": "Dict[str,str] auth_headers(self)", "description": "Generates the appropriate Authorization headers based on the authentication method.", "scope": "ConfluenceAuth", "scopeKind": "class"}, {"name": "None refresh_if_needed(self, client: httpx.AsyncClient)", "description": "Refreshes OAuth2 token if expired or near expiry.", "scope": "ConfluenceAuth", "scopeKind": "class"}, {"name": "None close(self)", "description": "Closes the underlying HTTP client session.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "float _sleep_delay(self, attempt: int)", "description": "Calculates exponential backoff delay with jitter for retries.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "httpx.Response _request(self, method: str, path: str, params: Optional[Dict[str, Any]] = None, json: Optional[Dict[str, Any]] = None)", "description": "Performs an HTTP request with retry logic for transient errors and rate limiting.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "Dict[str,Any] list_spaces(self, limit: int = 50, cursor: Optional[str] = None)", "description": "Retrieves a list of Confluence spaces with optional pagination.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "Dict[str,Any] list_pages(self, space_key: Optional[str] = None, limit: int = 50, cursor: Optional[str] = None)", "description": "Retrieves a list of pages in a space with optional pagination.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "Dict[str,Any] list_comments(self, page_id: str, limit: int = 50, cursor: Optional[str] = None)", "description": "Retrieves comments on a specific page with optional pagination.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "Dict[str,Any] create_page(self, space_key: str, title: str, body: str)", "description": "Creates a new Confluence page with specified space key, title, and body content.", "scope": "ConfluenceClient", "scopeKind": "class"}, {"name": "None __init__( self, base_url: str, method: str, access_token: Optional[str] = None, refresh_token: Optional[str] = None, client_id: Optional[str] = None, client_secret: Optional[str] = None, api_email: Optional[str] = None, api_token: Optional[str] = None, token_endpoint: Optional[str] = None, )", "scope": "ConfluenceAuth", "scopeKind": "class", "description": "unavailable"}, {"name": "None __init__(self, auth: ConfluenceAuth, timeout: float = 30.0, max_retries: int = 4, backoff_factor: float = 0.5)", "scope": "ConfluenceClient", "scopeKind": "class", "description": "unavailable"}], "calls": ["self.auth.refresh_if_needed", "self._client.request", "resp.raise_for_status", "resp.json", "base64.b64encode", "time.time", "asyncio.sleep", "random.random"], "search-terms": ["Confluence API", "OAuth2", "API key", "pagination", "list_spaces", "list_pages", "list_comments", "create_page"], "state": 2, "file_id": 31, "knowledge_revision": 76, "git_revision": "", "ctags": [{"_type": "tag", "name": "ConfluenceAuth", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^class ConfluenceAuth:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "ConfluenceClient", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^class ConfluenceClient:$/", "language": "Python", "kind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    def __init__($/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "( self, base_url: str, method: str, access_token: Optional[str] = None, refresh_token: Optional[str] = None, client_id: Optional[str] = None, client_secret: Optional[str] = None, api_email: Optional[str] = None, api_token: Optional[str] = None, token_endpoint: Optional[str] = None, )", "scope": "ConfluenceAuth", "scopeKind": "class"}, {"_type": "tag", "name": "__init__", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    def __init__(self, auth: ConfluenceAuth, timeout: float = 30.0, max_retries: int = 4, backof/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, auth: ConfluenceAuth, timeout: float = 30.0, max_retries: int = 4, backoff_factor: float = 0.5)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "_logger", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^_logger = get_logger(__name__)$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_request", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def _request(self, method: str, path: str, params: Optional[Dict[str, Any]] = None, js/", "language": "Python", "typeref": "typename:httpx.Response", "kind": "member", "signature": "(self, method: str, path: str, params: Optional[Dict[str, Any]] = None, json: Optional[Dict[str, Any]] = None)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "_sleep_delay", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    def _sleep_delay(self, attempt: int) -> float:$/", "language": "Python", "typeref": "typename:float", "kind": "member", "signature": "(self, attempt: int)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "auth_headers", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    def auth_headers(self) -> Dict[str, str]:$/", "language": "Python", "typeref": "typename:Dict[str,str]", "kind": "member", "signature": "(self)", "scope": "ConfluenceAuth", "scopeKind": "class"}, {"_type": "tag", "name": "close", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def close(self) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "create_page", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def create_page(self, space_key: str, title: str, body: str) -> Dict[str, Any]:$/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, space_key: str, title: str, body: str)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "list_comments", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def list_comments(self, page_id: str, limit: int = 50, cursor: Optional[str] = None) -/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, page_id: str, limit: int = 50, cursor: Optional[str] = None)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "list_pages", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def list_pages(self, space_key: Optional[str] = None, limit: int = 50, cursor: Optiona/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, space_key: Optional[str] = None, limit: int = 50, cursor: Optional[str] = None)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "list_spaces", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def list_spaces(self, limit: int = 50, cursor: Optional[str] = None) -> Dict[str, Any]/", "language": "Python", "typeref": "typename:Dict[str,Any]", "kind": "member", "signature": "(self, limit: int = 50, cursor: Optional[str] = None)", "scope": "ConfluenceClient", "scopeKind": "class"}, {"_type": "tag", "name": "refresh_if_needed", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    async def refresh_if_needed(self, client: httpx.AsyncClient) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, client: httpx.AsyncClient)", "scope": "ConfluenceAuth", "scopeKind": "class"}, {"_type": "tag", "name": "set_token", "path": "/home/kavia/workspace/code-generation/unified-connector-framework-143961-143970/unified_connector_backend/src/connectors/confluence/client.py", "pattern": "/^    def set_token(self, token: str, expires_in: Optional[int] = None) -> None:$/", "language": "Python", "typeref": "typename:None", "kind": "member", "signature": "(self, token: str, expires_in: Optional[int] = None)", "scope": "ConfluenceAuth", "scopeKind": "class"}], "hash": "02c063d99e632cb4a9f7f79f5d544f0b", "format-version": 4, "code-base-name": "unified_connector_backend", "filename": "unified_connector_backend/src/connectors/confluence/client.py", "fields": [{"name": "_logger = get_logger(__name__)", "scope": "", "scopeKind": "", "description": "unavailable"}], "revision_history": [{"76": ""}]}